{% extends "main.html" %}

{% block content %}
<main>
  <section class="py-4 text-center container">
    <div class="row py-lg-5">
      <div class="col-lg-6 col-md-8 mx-auto">
        <h1 class="fw-light">Call Center Clients</h1>
        <p class="lead text-muted"></p>
      </div>
    </div>
  </section>

  <div class="container">
    <div class="row">
      <div class="col-md-6 col-lg-5">
        <form method="get" class="mb-3">
          <div class="input-group">
            {{ stage_filter_form.stage }}
            <button type="submit" class="btn btn-primary">Filter</button>
          </div>
        </form>
      </div>
      <div class="col-md-6 col-lg-5 offset-lg-2">
        <form method="get" class="d-flex justify-content-end mb-3">
          <div class="input-group">
            <input type="text" name="query" class="form-control" placeholder="Search ph no...">
            <button type="submit" class="btn btn-primary">Search</button>
          </div>
        </form>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered table-hover">
        <thead>
          <tr>
            <th>Phone Number</th>
            <th>Gender</th>
            <th>Type</th>
            <th>Age Range</th>
            <th>Stage</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for client_phone in client_phones %}
            <tr>
              <td>{{ client_phone.phone_number }}</td>
              <td>{{ client_phone.client.gender }}</td>
              <td>{{ client_phone.client.type }}</td>
              <td>{{ client_phone.client.age_range }}</td>
              <td>{{ client_phone.client.stage }}</td>
              <td>
                <a href="{% url 'client_details' client_phone.client.id %}" type="button" class="btn btn-sm btn-outline-secondary">View Details</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-center">
      <nav aria-label="Page navigation">
        <ul class="pagination">
          {% if client_phones.has_previous %}
            <li class="page-item"><a class="page-link" href="?page=1{% if query %}&query={{ query }}{% endif %}{% if stage_filter_form.stage.value %}&stage={{ stage_filter_form.stage.value }}{% endif %}">&laquo;</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ client_phones.previous_page_number }}{% if query %}&query={{ query }}{% endif %}{% if stage_filter_form.stage.value %}&stage={{ stage_filter_form.stage.value }}{% endif %}">previous</a></li>
          {% else %}
            <li class="page-item disabled"><a class="page-link">&laquo;</a></li>
            <li class="page-item disabled"><a class="page-link">previous</a></li>
          {% endif %}

            {% for i in client_phones.paginator.page_range %}
  {% if client_phones.number == i %}
    <li class="page-item active"><a class="page-link">{{ i }}</a></li>
  {% else %}
    <li class="page-item"><a class="page-link" href="?page={{ i }}{% if query %}&query={{ query }}{% endif %}{% if stage_filter_form.stage.value %}&stage={{ stage_filter_form.stage.value }}{% endif %}">{{ i }}</a></li>
  {% endif %}
{% endfor %}

{% if client_phones.has_next %}
  <li class="page-item"><a class="page-link" href="?page={{ client_phones.next_page_number }}{% if query %}&query={{ query }}{% endif %}{% if stage_filter_form.stage.value %}&stage={{ stage_filter_form.stage.value }}{% endif %}">next</a></li>
  <li class="page-item"><a class="page-link" href="?page={{ client_phones.paginator.num_pages }}{% if query %}&query={{ query }}{% endif %}{% if stage_filter_form.stage.value %}&stage={{ stage_filter_form.stage.value }}{% endif %}">&raquo;</a></li>
{% else %}
  <li class="page-item disabled"><a class="page-link">next</a></li>
  <li class="page-item disabled"><a class="page-link">&raquo;</a></li>
{% endif %}
</ul>
</nav>
</div>
</div>
</main>
{% endblock %}

